# Backend localization

Strings generated by the backend, like the error messages, have to be localized if the application supports multiple languages.

The Larave mechanisms produce the messages in the correct language. It is easier than to generate in english and parse the messages to translate them in the client.

Here is the laravel documentation on localization.
https://laravel.com/docs/11.x/localization

The support is implemented with an HTTP lang parameter. The API defaults to english when the lang parameter is not supported.

http://127.0.0.1:8000/api/boards?lang=nl


## Setup

    php artisan lang:publish

The default language is stored in config/app.php (en by default)

To set the locale:

    use Illuminate\Support\Facades\App;

    if (! in_array($locale, ['en', 'fr'])) {
        abort(400);
    }

    App::setLocale($locale);

The french translation can be found here https://github.com/s-damian/laravel-lang-fr

The idea is to add a lang parameter to the API and return messages in the correct language.


## Table and column names

The database schema and table and column names are defined in english.

The table and column names should never be displayed to the user.

The solution is to have translation files with the keys:

* table.boards
* column.boards.name
* column.boards.description
* column.boards.favorite

```
__('table.board')

'welcome' => 'Welcome, :name',

echo __('messages.welcome', ['name' => 'dayle']);

'welcome' => 'Welcome, :NAME', // Welcome, DAYLE
'goodbye' => 'Goodbye, :Name', // Goodbye, Dayle
```

## Translation API

The API provides error messages in different languages but can also provide translations for the data structure serrved through the API. Clients can fetch data but also the translated strings to present the data.

It is done through a specific API.

GET http://127.0.0.1:8000/api/translation

Will return everithing on translations.

    {"lang": "fr",
		"tables": {
			"boards": "Tableaux",
			"columns": "Listes",
			"tasks": "Tasks"
		},
		"fields": {
			"boards": {
                "name": "Nom",
                "description": "Description",
                "email": "courriel"
			},
            "tasks": {
                ...
            }
        }
    }

GET http://127.0.0.1:8000/api/translation/table?lang=fr&table=tasks

Returns everything on the table tasks.

An additional level on columns will be developped if needed.

## Tests

```
php artisan test --filter=APILocalization
php artisan test --filter=Translation
```